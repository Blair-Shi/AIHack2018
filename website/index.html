<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, width=device-width" />
<link rel="stylesheet" type="text/css" href="https://js.api.here.com/v3/3.0/mapsjs-ui.css?dp-version=1533195059" />
<script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-core.js"></script>
<script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-service.js"></script>
<script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-ui.js"></script>
<script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-mapevents.js"></script>
<script src="http://maps.google.com/maps/api/js?sensor=true&key=AIzaSyBlHubJVUz2T6ac71YX91DY3j2Ddfjmyko"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>	
  
<title> UK Accident Map</title>
</head>

<body>
  <center><h1> UK Road Accident Map </h1></center>
  <center><div id="map" style="width: 600px; height: 500px; background: grey" /></center>
  <form id="calculate-route" name="calculate-route" action="#" method="get">
  <label for="from">From:</label>
  <input type="text" id="from" name="from" required="required" placeholder="An address" size="30" />
  <a id="from-link" href="#">Get my position</a>
  <br />

  <label for="to">To:</label>
  <input type="text" id="to" name="to" required="required" placeholder="Another address" size="30" />
  <a id="to-link" href="#">Get my position</a>
  <br />

  <input type="submit" />
  <input type="reset" />
</form>

  <script  type="text/javascript" charset="UTF-8" >
 
/**
 * Adds a polyline between Dublin, London, Paris and Berlin to the map
 *
 * @param  {H.Map} map      A HERE Map instance within the application
 */
function addPolylineToMap(map) {
  var lineString = new H.geo.LineString();

  lineString.pushPoint({lat:53.3477, lng:-6.2597});
  lineString.pushPoint({lat:51.5008, lng:-0.1224});
  lineString.pushPoint({lat:48.8567, lng:2.3508});
  lineString.pushPoint({lat:52.5166, lng:13.3833});

  map.addObject(new H.map.Polyline(
    lineString, { style: { lineWidth: 4 }}
  ))
  
  ;
}


/**
 * Boilerplate map initialization code starts below:
 */

//Step 1: initialize communication with the platform
var platform = new H.service.Platform({
  app_id: 'jVFwk67SyWLgvh9iVVBK',
  app_code: 'eujq55lMNjTE2HVPM-Rb4Q',
  useHTTPS: true
});
var pixelRatio = window.devicePixelRatio || 1;
var defaultLayers = platform.createDefaultLayers({
  tileSize: pixelRatio === 1 ? 256 : 512,
  ppi: pixelRatio === 1 ? undefined : 320
});

//Step 2: initialize a map - this map is centered over Europe
var map = new H.Map(document.getElementById('map'),
  defaultLayers.normal.map,{
  center: {lat:51.5074, lng:0.1278},
  zoom: 8,
  pixelRatio: pixelRatio
});


//Step 3: make the map interactive
// MapEvents enables the event system
// Behavior implements default interactions for pan/zoom (also on mobile touch environments)
var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));

// Create the default UI components
var ui = H.ui.UI.createDefault(map, defaultLayers);

//.................................................................................................................
APIKEY = "AIzaSyBlHubJVUz2T6ac71YX91DY3j2Ddfjmyko";
requestURL = "https://maps.googleapis.com/maps/api/directions/json?origin=Brooklyn&destination=Queens&mode=transit&key=" + APIKEY + "callback=?";

$("#calculate-route").submit(function(event) {
  event.preventDefault();
  console.log("asdf");
  calculateRoute($("#from").val(), $("#to").val());
});
var from = "London";
var to = "Bournemouth";
var directionsService = new google.maps.DirectionsService();
var directionsRequest = {
  origin: from,
  destination: to,
  travelMode: google.maps.DirectionsTravelMode.DRIVING,
  unitSystem: google.maps.UnitSystem.METRIC
};

var steps = new Array();
directionsService.route(
  directionsRequest,
  function(response, status)
  {
    if (status == google.maps.DirectionsStatus.OK)
    {
      var paths = response.routes[0].legs[0].steps;
      console.log(paths);
      for(var i = 0; i < paths.length; i++){
        //steps.push(paths[i].polyline);
        //console.log(paths[i].polyline);
      }
    }
    else
      $("#error").append("Unable to retrieve your route<br />");
  }
);

for(var i = 0; i < steps.length; i++){
//console.log(steps[i]);
map.addObject(steps[i]);
}

addPolylineToMap(map);
  </script>
</body>
</html>